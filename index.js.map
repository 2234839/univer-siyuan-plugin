{"version":3,"file":"index.js","sources":["../../src/libs/siyuanPlugin.ts","../../src/libs/api.ts","../../src/libs/js_util.ts","../../src/univer-siyuan-plugin/index.ts"],"sourcesContent":["import { Plugin } from \"siyuan\";\r\nexport class SiyuanPlugin extends Plugin {\r\n  // 在 unload 时执行注册的函数\r\n  addUnloadFn(fn: () => void) {\r\n    this.onunloadFn.push(fn);\r\n  }\r\n  onunloadFn: (() => void)[] = [];\r\n  onunload(): void {\r\n    this.onunloadFn.forEach((fn) => fn());\r\n  }\r\n}\r\n","/**\n * Copyright (c) 2023 frostime. All rights reserved.\n * https://github.com/frostime/sy-plugin-template-vite\n *\n * See API Document in [API.md](https://github.com/siyuan-note/siyuan/blob/master/API.md)\n * API 文档见 [API_zh_CN.md](https://github.com/siyuan-note/siyuan/blob/master/API_zh_CN.md)\n */\n\nimport { fetchSyncPost, IWebSocketData } from \"siyuan\";\n\nasync function request(url: string, data: any) {\n  let response: IWebSocketData = await fetchSyncPost(url, data);\n  let res = response.code === 0 ? response.data : null;\n  return res;\n}\n\n// **************************************** Noteboook ****************************************\n\nexport async function lsNotebooks(): Promise<IReslsNotebooks> {\n  let url = \"/api/notebook/lsNotebooks\";\n  return request(url, \"\");\n}\n\nexport async function openNotebook(notebook: NotebookId) {\n  let url = \"/api/notebook/openNotebook\";\n  return request(url, { notebook: notebook });\n}\n\nexport async function closeNotebook(notebook: NotebookId) {\n  let url = \"/api/notebook/closeNotebook\";\n  return request(url, { notebook: notebook });\n}\n\nexport async function renameNotebook(notebook: NotebookId, name: string) {\n  let url = \"/api/notebook/renameNotebook\";\n  return request(url, { notebook: notebook, name: name });\n}\n\nexport async function createNotebook(name: string): Promise<Notebook> {\n  let url = \"/api/notebook/createNotebook\";\n  return request(url, { name: name });\n}\n\nexport async function removeNotebook(notebook: NotebookId) {\n  let url = \"/api/notebook/removeNotebook\";\n  return request(url, { notebook: notebook });\n}\n\nexport async function getNotebookConf(notebook: NotebookId): Promise<IResGetNotebookConf> {\n  let data = { notebook: notebook };\n  let url = \"/api/notebook/getNotebookConf\";\n  return request(url, data);\n}\n\nexport async function setNotebookConf(\n  notebook: NotebookId,\n  conf: NotebookConf,\n): Promise<NotebookConf> {\n  let data = { notebook: notebook, conf: conf };\n  let url = \"/api/notebook/setNotebookConf\";\n  return request(url, data);\n}\n\n// **************************************** File Tree ****************************************\nexport async function createDocWithMd(\n  notebook: NotebookId,\n  path: string,\n  markdown: string,\n): Promise<DocumentId> {\n  let data = {\n    notebook: notebook,\n    path: path,\n    markdown: markdown,\n  };\n  let url = \"/api/filetree/createDocWithMd\";\n  return request(url, data);\n}\n\nexport async function renameDoc(\n  notebook: NotebookId,\n  path: string,\n  title: string,\n): Promise<DocumentId> {\n  let data = {\n    doc: notebook,\n    path: path,\n    title: title,\n  };\n  let url = \"/api/filetree/renameDoc\";\n  return request(url, data);\n}\n\nexport async function removeDoc(notebook: NotebookId, path: string) {\n  let data = {\n    notebook: notebook,\n    path: path,\n  };\n  let url = \"/api/filetree/removeDoc\";\n  return request(url, data);\n}\n\nexport async function moveDocs(fromPaths: string[], toNotebook: NotebookId, toPath: string) {\n  let data = {\n    fromPaths: fromPaths,\n    toNotebook: toNotebook,\n    toPath: toPath,\n  };\n  let url = \"/api/filetree/moveDocs\";\n  return request(url, data);\n}\n\nexport async function getHPathByPath(notebook: NotebookId, path: string): Promise<string> {\n  let data = {\n    notebook: notebook,\n    path: path,\n  };\n  let url = \"/api/filetree/getHPathByPath\";\n  return request(url, data);\n}\n\nexport async function getHPathByID(id: BlockId): Promise<string> {\n  let data = {\n    id: id,\n  };\n  let url = \"/api/filetree/getHPathByID\";\n  return request(url, data);\n}\n\n// **************************************** Asset Files ****************************************\n\nexport async function upload(assetsDirPath: string, files: string | Blob[]): Promise<IResUpload> {\n  let form = new FormData();\n  form.append(\"assetsDirPath\", assetsDirPath);\n  for (let file of files) {\n    form.append(\"file[]\", file);\n  }\n  let url = \"/api/asset/upload\";\n  return request(url, form);\n}\n\n// **************************************** Block ****************************************\ntype DataType = \"markdown\" | \"dom\";\nexport async function insertBlock(\n  dataType: DataType,\n  data: string,\n  nextID?: BlockId,\n  previousID?: BlockId,\n  parentID?: BlockId,\n): Promise<IResdoOperations[]> {\n  let payload = {\n    dataType: dataType,\n    data: data,\n    nextID: nextID,\n    previousID: previousID,\n    parentID: parentID,\n  };\n  let url = \"/api/block/insertBlock\";\n  return request(url, payload);\n}\n\nexport async function prependBlock(\n  dataType: DataType,\n  data: string,\n  parentID: BlockId | DocumentId,\n): Promise<IResdoOperations[]> {\n  let payload = {\n    dataType: dataType,\n    data: data,\n    parentID: parentID,\n  };\n  let url = \"/api/block/prependBlock\";\n  return request(url, payload);\n}\n\nexport async function appendBlock(\n  dataType: DataType,\n  data: string,\n  parentID: BlockId | DocumentId,\n): Promise<IResdoOperations[]> {\n  let payload = {\n    dataType: dataType,\n    data: data,\n    parentID: parentID,\n  };\n  let url = \"/api/block/appendBlock\";\n  return request(url, payload);\n}\n\nexport async function updateBlock(\n  dataType: DataType,\n  data: string,\n  id: BlockId,\n): Promise<IResdoOperations[]> {\n  let payload = {\n    dataType: dataType,\n    data: data,\n    id: id,\n  };\n  let url = \"/api/block/updateBlock\";\n  return request(url, payload);\n}\n\nexport async function deleteBlock(id: BlockId): Promise<IResdoOperations[]> {\n  let data = {\n    id: id,\n  };\n  let url = \"/api/block/deleteBlock\";\n  return request(url, data);\n}\n\nexport async function moveBlock(\n  id: BlockId,\n  previousID?: PreviousID,\n  parentID?: ParentID,\n): Promise<IResdoOperations[]> {\n  let data = {\n    id: id,\n    previousID: previousID,\n    parentID: parentID,\n  };\n  let url = \"/api/block/moveBlock\";\n  return request(url, data);\n}\n\nexport async function getBlockKramdown(id: BlockId): Promise<IResGetBlockKramdown> {\n  let data = {\n    id: id,\n  };\n  let url = \"/api/block/getBlockKramdown\";\n  return request(url, data);\n}\n\nexport async function getChildBlocks(id: BlockId): Promise<IResGetChildBlock[]> {\n  let data = {\n    id: id,\n  };\n  let url = \"/api/block/getChildBlocks\";\n  return request(url, data);\n}\n\nexport async function transferBlockRef(fromID: BlockId, toID: BlockId, refIDs: BlockId[]) {\n  let data = {\n    fromID: fromID,\n    toID: toID,\n    refIDs: refIDs,\n  };\n  let url = \"/api/block/transferBlockRef\";\n  return request(url, data);\n}\n\n// **************************************** Attributes ****************************************\nexport async function setBlockAttrs(id: BlockId, attrs: { [key: string]: string }) {\n  let data = {\n    id: id,\n    attrs: attrs,\n  };\n  let url = \"/api/attr/setBlockAttrs\";\n  return request(url, data);\n}\n\nexport async function getBlockAttrs(id: BlockId): Promise<{ [key: string]: string }> {\n  let data = {\n    id: id,\n  };\n  let url = \"/api/attr/getBlockAttrs\";\n  return request(url, data);\n}\n\n// **************************************** SQL ****************************************\n\nexport async function sql(sql: string): Promise<any[]> {\n  let sqldata = {\n    stmt: sql,\n  };\n  let url = \"/api/query/sql\";\n  return request(url, sqldata);\n}\n\nexport async function getBlockByID(blockId: string): Promise<Block> {\n  let sqlScript = `select * from blocks where id ='${blockId}'`;\n  let data = await sql(sqlScript);\n  return data[0];\n}\n\n// **************************************** Template ****************************************\n\nexport async function render(id: DocumentId, path: string): Promise<IResGetTemplates> {\n  let data = {\n    id: id,\n    path: path,\n  };\n  let url = \"/api/template/render\";\n  return request(url, data);\n}\n\nexport async function renderSprig(template: string): Promise<string> {\n  let url = \"/api/template/renderSprig\";\n  return request(url, { template: template });\n}\n\n// **************************************** File ****************************************\n\n/**\n * https://github.com/siyuan-note/siyuan/blob/master/API_zh_CN.md#%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6\n * \"/data/box_id/doc_id.sy\"\n */\nexport async function getFile(path: string): Promise<any> {\n  let data = {\n    path: path,\n  };\n  let url = \"/api/file/getFile\";\n  try {\n    let file = await fetchSyncPost(url, data);\n    return file;\n  } catch (error_msg) {\n    throw error_msg\n  }\n}\n\nexport async function putFile(path: string, isDir: boolean, file: any) {\n  let form = new FormData();\n  form.append(\"path\", path);\n  form.append(\"isDir\", isDir.toString());\n  // Copyright (c) 2023, terwer.\n  // https://github.com/terwer/siyuan-plugin-importer/blob/v1.4.1/src/api/kernel-api.ts\n  form.append(\"modTime\", Math.floor(Date.now() / 1000).toString());\n  form.append(\"file\", file);\n  let url = \"/api/file/putFile\";\n  return request(url, form);\n}\n\nexport async function removeFile(path: string) {\n  let data = {\n    path: path,\n  };\n  let url = \"/api/file/removeFile\";\n  return request(url, data);\n}\n\nexport async function readDir(path: string): Promise<IResReadDir> {\n  let data = {\n    path: path,\n  };\n  let url = \"/api/file/readDir\";\n  return request(url, data);\n}\n\n// **************************************** Export ****************************************\n\nexport async function exportMdContent(id: DocumentId): Promise<IResExportMdContent> {\n  let data = {\n    id: id,\n  };\n  let url = \"/api/export/exportMdContent\";\n  return request(url, data);\n}\n\nexport async function exportResources(paths: string[], name: string): Promise<IResExportResources> {\n  let data = {\n    paths: paths,\n    name: name,\n  };\n  let url = \"/api/export/exportResources\";\n  return request(url, data);\n}\n\n// **************************************** Convert ****************************************\n\nexport type PandocArgs = string;\nexport async function pandoc(args: PandocArgs[]) {\n  let data = {\n    args: args,\n  };\n  let url = \"/api/convert/pandoc\";\n  return request(url, data);\n}\n\n// **************************************** Notification ****************************************\n\n// /api/notification/pushMsg\n// {\n//     \"msg\": \"test\",\n//     \"timeout\": 7000\n//   }\nexport async function pushMsg(msg: string, timeout: number = 7000) {\n  let payload = {\n    msg: msg,\n    timeout: timeout,\n  };\n  let url = \"/api/notification/pushMsg\";\n  return request(url, payload);\n}\n\nexport async function pushErrMsg(msg: string, timeout: number = 7000) {\n  let payload = {\n    msg: msg,\n    timeout: timeout,\n  };\n  let url = \"/api/notification/pushErrMsg\";\n  return request(url, payload);\n}\n\n// **************************************** Network ****************************************\nexport async function forwardProxy(\n  url: string,\n  method: string = \"GET\",\n  payload: any = {},\n  headers: any[] = [],\n  timeout: number = 7000,\n  contentType: string = \"text/html\",\n): Promise<IResForwardProxy> {\n  let data = {\n    url: url,\n    method: method,\n    timeout: timeout,\n    contentType: contentType,\n    headers: headers,\n    payload: payload,\n  };\n  let url1 = \"/api/network/forwardProxy\";\n  return request(url1, data);\n}\n\n// **************************************** System ****************************************\n\nexport async function bootProgress(): Promise<IResBootProgress> {\n  return request(\"/api/system/bootProgress\", {});\n}\n\nexport async function version(): Promise<string> {\n  return request(\"/api/system/version\", {});\n}\n\nexport async function currentTime(): Promise<number> {\n  return request(\"/api/system/currentTime\", {});\n}\n\nexport async function insertLocalAssets(data: {\n  assetPaths: string[];\n  isUpload: boolean;\n  id: string;\n}): Promise<{\n  succMap: {\n    [assetFileName: string]: string;\n  };\n}> {\n  return request(\"/api/asset/insertLocalAssets\", data);\n}\n","export function debounce(fn: Function, delay: number) {\r\n  // 保存定时器的ID\r\n  let timerId: any;\r\n\r\n  // 返回一个新的函数，这个函数将在延迟时间后执行传入的函数fn\r\n  return function (this: any, ...args: any) {\r\n    // 每次触发事件时，如果存在定时器，先清除之前的定时器\r\n    if (timerId) {\r\n      clearTimeout(timerId);\r\n    }\r\n\r\n    // 设置一个新的定时器\r\n    timerId = setTimeout(() => {\r\n      // 延迟时间后执行传入的函数，并传入相应的参数\r\n      fn.apply(this, args);\r\n    }, delay);\r\n  };\r\n}\r\nexport function generateTimestamp() {\r\n  const now = new Date();\r\n  return [\r\n    now.getFullYear(),\r\n    now.getMonth() + 1,\r\n    now.getDate(),\r\n    now.getHours(),\r\n    now.getMinutes(),\r\n    now.getSeconds(),\r\n  ]\r\n    .map((part) => part.toString().padStart(2, \"0\"))\r\n    .join(\"\");\r\n}\r\nexport function encodeHTML(str: string) {\r\n  return str.replace(/[&<>\"'\\n]/g, function (match) {\r\n    return {\r\n      \"&\": \"&amp;\",\r\n      \"<\": \"&lt;\",\r\n      \">\": \"&gt;\",\r\n      '\"': \"&quot;\",\r\n      \"'\": \"&#39;\",\r\n      \"\\n\": \"_esc_newline_\",\r\n    }[match]!;\r\n  });\r\n}\r\n\r\nexport function generateUniqueId() {\r\n  // 生成随机字符串\r\n  const randomString = Math.random().toString(36).substring(2, 9);\r\n\r\n  // 组合成最终的 ID\r\n  return `${generateTimestamp()}-${randomString}`;\r\n}","import type { apiRpcData, apiRpcReply } from \"~/libs/apiProxy\";\r\nimport { SiyuanPlugin } from \"~/libs/siyuanPlugin\";\r\n// 引入这个变量后 vite 会自动注入 hot\r\nimport.meta.hot;\r\nimport * as apis from \"~/libs/api\";\r\nimport { Menu } from \"siyuan\";\r\nimport { generateTimestamp, generateUniqueId } from \"~/libs/js_util\";\r\nimport type { checkId } from \"./msg\";\r\nexport default class UniverPlugin extends SiyuanPlugin {\r\n  onload(): void {\r\n    this.eventBus.on(\"click-blockicon\", (e) => {\r\n      const menu = window.siyuan.menus.menu as Menu;\r\n      menu.addSeparator();\r\n      menu.addItem({\r\n        label: \"univer:插入 sheet \",\r\n        icon: ``,\r\n        click: () => {\r\n          const id = generateUniqueId();\r\n          const updated = generateTimestamp();\r\n          apis.insertBlock(\r\n            \"markdown\",\r\n            kramdownIframe({\r\n              updated,\r\n              id,\r\n              src: `/plugins/univer-siyuan-plugin/univer.html?id=${id}&type=sheet`,\r\n            }),\r\n            undefined,\r\n            e.detail.blockElements[0]?.dataset.nodeId,\r\n          );\r\n        },\r\n      });\r\n    });\r\n  }\r\n  onLayoutReady(): void {\r\n    // @ts-expect-error\r\n    window[\"univerPlugin\"] = this;\r\n    const fn = async (ev: MessageEvent<apiRpcData | checkId>) => {\r\n      const event = ev.data;\r\n      if (event.type === \"llej-plugin-rpc-univer-check-id\") {\r\n        const iframeList = document.querySelectorAll<HTMLIFrameElement>(\r\n          `iframe[src*=\"univer-siyuan-plugin/univer.html?id=${event.blockId}\"]`,\r\n        );\r\n        for (const iframe of iframeList) {\r\n          const block = iframe.closest<HTMLDivElement>('[data-type=\"NodeIFrame\"]')!;\r\n          const blockId = block.dataset.nodeId!;\r\n          if (blockId !== event.blockId) {\r\n            await new Promise((r) => setTimeout(r, 500));\r\n            const newSrc = iframe.src.replace(\r\n              `id=${event.blockId}`,\r\n              `id=${blockId}&copy=${event.blockId}`,\r\n            );\r\n            await apis.updateBlock(\r\n              \"markdown\",\r\n              kramdownIframe({\r\n                updated: generateTimestamp(),\r\n                id: blockId,\r\n                src: newSrc,\r\n              }),\r\n              blockId,\r\n            );\r\n          }\r\n        }\r\n      } else if (event.type === \"llej-plugin-rpc\") {\r\n        const payload = event.payload;\r\n        const iframeList = [\r\n          ...document.querySelectorAll(\r\n            `iframe[src*=\"univer-siyuan-plugin/univer.html?id=${payload.blockId}\"]`,\r\n          ),\r\n        ] as HTMLIFrameElement[];\r\n        //@ts-expect-error\r\n        apis[payload.apiName](...payload.args).then((res) => {\r\n          const reply: apiRpcReply = {\r\n            type: \"llej-plugin-rpc-reply\",\r\n            msgID: event.msgID,\r\n            payload: res,\r\n          };\r\n          iframeList.forEach((iframe) => {\r\n            iframe.contentWindow?.postMessage(reply, \"*\");\r\n          });\r\n        });\r\n      }\r\n    };\r\n    window.addEventListener(\"message\", fn);\r\n  }\r\n}\r\n\r\nconst kramdownIframe = (par: { updated: string; id: string; src: string }) => {\r\n  return `<iframe sandbox=\"allow-forms allow-presentation allow-same-origin allow-scripts allow-modals allow-popups\" src=\"${par.src}\" data-src=\"\" border=\"0\" frameborder=\"no\" framespacing=\"0\" allowfullscreen=\"true\" style=\"width: 794px; height: 636px;\"></iframe>\r\n\r\n{: updated=\"${par.updated}\" id=\"${par.id}\"}`;\r\n};\r\n"],"names":["Plugin","SiyuanPlugin","__publicField","fn","fetchSyncPost","request","url","data","response","lsNotebooks","openNotebook","notebook","closeNotebook","renameNotebook","name","createNotebook","removeNotebook","getNotebookConf","setNotebookConf","conf","createDocWithMd","path","markdown","renameDoc","title","removeDoc","moveDocs","fromPaths","toNotebook","toPath","getHPathByPath","getHPathByID","id","upload","assetsDirPath","files","form","file","insertBlock","dataType","nextID","previousID","parentID","prependBlock","appendBlock","updateBlock","deleteBlock","moveBlock","getBlockKramdown","getChildBlocks","transferBlockRef","fromID","toID","refIDs","setBlockAttrs","attrs","getBlockAttrs","sql","getBlockByID","blockId","sqlScript","render","renderSprig","template","getFile","error_msg","putFile","isDir","removeFile","readDir","exportMdContent","exportResources","paths","pandoc","args","pushMsg","msg","timeout","pushErrMsg","forwardProxy","method","payload","headers","contentType","bootProgress","version","currentTime","insertLocalAssets","generateTimestamp","now","part","generateUniqueId","randomString","UniverPlugin","menu","updated","apis.insertBlock","kramdownIframe","_a","ev","event","iframeList","iframe","r","newSrc","apis.updateBlock","apis","res","reply","par"],"mappings":"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"}